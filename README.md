
# تحلیل داده‌های هواشناسی و الگوهای بارش در شهرهای ایران

##  معرفی پروژه

این پروژه با هدف تحلیل داده‌های هواشناسی در سه شهر تهران، قم و رشت، در بازه زمانی 2020 تا 2024 انجام شده است. تمرکز اصلی پروژه بر پیدا کردن یک الگوی بارشی در هر فصل است. به همین منظور عوامل متعددی از جمله دما، میزان بارش(برف و باران) و بین سه شهر را بررسی کرده تا عواملی که تاثیر بیشتری  بر الگوی بارشی دارند را بتواینم پیدا کنیم. این پروژه از بخش های مختلفی تشکیل شده است که بصورت کامل به توضیح در م
##  پیش‌نیازها

برای اجرای این نوت ‌بوک نیاز به نصب پکیج‌ های زیر دارید که در فایل `requirements.txt` نیز آمده است:

```
pandas~=2.3.1
numpy~=2.3.1
seaborn~=0.13.2
matplotlib~=3.10.3
jdatetime~=5.2.0
tabulate~=0.9.0
scikit-learn~=1.7.0
```

نصب با دستور:
```bash
pip install -r requirements.txt
```

## مراحل انجام تحلیل

### 1. خواندن داده‌ ها
داده‌های هواشناسی از فایل weather.csv بارگذاری شده‌اند. این داده ها از سایت  open-mateo دانلود شده اند و برای این که نتایج ارزیابی دقیق تر باشد دیتای 5 سال در پروژه در نظر گرفته شده است.

### 2. بهینه ‌سازی داده ‌ها
برای کاهش حجم فایل داده از تابع  `auto_data_type`  استفاده شده است که همه داده ها را بررسی کرده و آن ها را به دیتا تایپی که باعث می شود حجم کمتری بگیرد وداده ای از بین نرود، تبدیل کند. این کار باعث می شود حافظه کمتری مصرف شود.


همان طور که در شکل زیر مشخص است پس از تبدیل نوع داده ها با کاهش حجم حدود 43 درصد مواجه شدیم.
![پیش_پردازش_داده ها](images/pre_processing.png)


### 3. تشخیص داده ‌های پرت و حذف آن ها 
بر اساس نمودار زیر می توان نتیجه گرفت که در شهر رشت چند داده پرت وجود دارد به عبارتی دیگر در بعضی از روز ها بارش غیر معمول داشته است. به همین خاطر برای این که داده ها را در شرایط نرمال بررسی کنیم، این داده ها را حذف می کنیم. حذف داده های پرت با استفاده از میانگین و انحراف معیار انجام شده است که داده هایی در بازه [میانگین - ۳ * انحراف معیار, میانگین + ۳ * انحراف معیار]  هستند را نگه می داریم. ضریبی که برای انحراف معیار در نظر گرفته شده است می تواند بر اساس داده ای دیگر تغییر کند.
![داده های پرت](images/outlyer.png)


### 5.   استخراج ویژگی
برای این که بتوانیم تحلیل دقیق تری در هر فصل داشته باشیم، از ستون time اطلاعاتی از جمله سال میلادی ، ماه میلادی، فصل میلادی استخراج و به مجموعه داده‌ها اضافه شد. سپس، با استفاده از کتابخانه jdatetime، تاریخ‌ها به معادل شمسی تبدیل شده‌اند تا درک بهتری از الگوهای فصلی در تقویم ایرانی فراهم شود. این مرحله کمک می‌کند که داده‌ها بر اساس فصل و سال دسته‌بندی شده و در تحلیل‌های بعدی (مثل بررسی توالی بارش 

### 5.   نرمال سازی

برای این که بررسی دقیق تری بر روی میزان بارش ها داشته باشیم، نمودار زیر بصورت میانیگین بارش ماهانه در هر شهر رسم شده است اما چون میزان بارش شهر رشت به مراتب بیشتر از تهران و قم بوده است، مقایسه مستقیم این مقادیر ممکن است باعث گمراهی در تحلیل شود. برای حل این مشکل، از نرمال‌سازی به روش Min-Max Scaling استفاده شده است. این روش، مقادیر بارش را به بازه‌ای بین ۰ و ۱ تبدیل می‌کند و امکان مقایسه نسبت‌ها 

![نرمال_سازی](images/scaling.png)


### 5.  پیدا کردن عوامل موثر
با استفاده نمودار heatmap می توان نتیجه گرفت که بین دما و میزان بارش همبستگی قوی ای وجود دارد و ارتباط بین آن ها نیز معکوس است. بطور مثال هر چه دما پایین تر باشد میزان بارش بیشتر است و بالعکس.  این نتیجه را می توان در  پلات زیر هم مشاهده کرد که بیشتر بارش ها در فصل های پاییز و زمستان در هر سه شهر رخ داده است. هم چنین می توان نتیجه گرفت که اگر بعد از هر شهری، شهر دیگری کاهش دمایی را تجربه کند این ا

![ارتباط بین عوامل](images/heatmap.png)

در این نمودار می‌توان نتیجه گرفت که رشت در تمام طول سال به ‌مراتب پربارش‌تر است و اوج بارش آن در اواخر پاییز و زمستان (آبان، آذر، دی و بهمن) رخ می‌دهد، در حالی که قم و تهران در اغلب ماه‌ها تقریباً خشک‌اند و تنها در فصل زمستان (دی تا اسفند) کمی بارش دارند. پس انتظار می‌رود رشت در الگوی بارشی همیشه اولین شهر باشد.

<p align="center">
  <img src="images/Average_precipitation.png" alt="بارش میانگین" width="45%" />
  <img src="images/Annual_precipitation.png" alt="بارش سالانه" width="45%" />
</p>


 در نمودار زیر شهر ها را  بصورت برف، باران و مجموع بارش ها که ترکیبی از هر دو هست را برررسی کردیم.مشاهده می شود که در هر سه شهر بیشتر روز ها یا بارانی هست یا خیلی کم باران می‌ بارد، و فقط شهر رشت در یک سری از روز ها پر بارش یا برفی است
![بارش میانگین](images/precipitation.png)



## 📊 نتایج پروژه

- تهران بارش متعادل‌تری دارد و در زمستان افزایش بارش دیده می‌شود.
- قم کم‌باران‌ترین شهر است و بیشترین بارش آن در پاییز و زمستان رخ می‌دهد.
- رشت بیشترین بارش را دارد، مخصوصاً در پاییز.
- توالی بارش در فصل‌ها تحلیل شده و رایج‌ترین الگوهای گردش بارش بین شهرها نمایش داده شده‌اند.

نمونه خروجی جداول توالی بارش ها به تفکیک هر فصل:
همان طور که در تصویر زیر مشاهده می کنید به تفیکی هر فصل الگو های بارشی استخراج شده است. با استفاده از داده ها، زمانی که بارش در هر شهری شروع می شود این را به عنوان نقطه ابتدایی در نظر گرفته می شود و در روز ها آتی بررسی می شود که در چه شهر های دیگری بارندگی رخ می دهد. با استفاده از این روش در هر فصل به یک سری از الگو های بارشی می رسیم. همان طور که در عکس زیر مشاهده می کنید برای هر الگویی که پیدا دشه است تعداد دفعاتی که این الگو در آن فصل و در سال های 2020 تا 2024 رخ داده است را محاسبه می کنیم. در پایان الگویی که بیشترین تکرار را داشته است به عنوان الگوی رایج در آن فصل در نظر گرفته شده است.

![خروجی پروژه](images/output.png)

لازم به ذکر است که در فصل تابستان چون عمدتا بارشی رخی نداده است، در نتیجه الگوی بارشی ای یافت نشده است.

